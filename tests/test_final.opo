"std/net" => net: imp
"std/json" => json: imp
"std/regex" => re: imp
"std/fs" => fs: imp

<ch: chan<any>> -> void: fetch_worker [
    "Worker started, fetching Zen..." !!
    net.get("https://api.github.com/zen") => zen: str
    "Worker fetched Zen: " + zen !!
    ch <- zen
]

<> -> void: main [
    chan<any>(1) => ch: chan<any>
    
    go fetch_worker(ch)
    
    "Main waiting..." !! ;
    <-ch => result: any
    
    match result [
        str(s) [
            "Main received Zen: " + s !!
            
            # Check if it has 'Opo' (it won't, but let's test regex)
            re.is_match("Opo", s) ? [
                "Zen mentions Opo!" !!
            ] : [
                "Zen does not mention Opo." !!
            ]
            
            # Write to file
            fs.write_file("zen.txt", s) !!
            "Written to zen.txt" !!
        ]
        void [
            "Main received nothing." !!
        ]
    ]
    
    fs.exists("zen.txt") ? [
        "Verified: zen.txt exists." !!
        fs.list_dir(".") => files: []str
        "File count: " + str(len(files)) !!
        fs.remove("zen.txt") !!
        "zen.txt cleaned up." !!
    ] : [
        "zen.txt missing!" !!
    ]
    
    "All tests completed successfully." !!
]
